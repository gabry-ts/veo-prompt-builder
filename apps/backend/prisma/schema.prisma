generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  ADMIN
  USER
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String?
  role      UserRole @default(USER)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  prompts   Prompt[]

  @@map("users")
}

model Prompt {
  id           String          @id @default(cuid())
  name         String
  description  String?
  jsonData     Json
  userId       String
  user         User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  tags         String[]        @default([])
  isFavorite   Boolean         @default(false)
  rating       Int?
  shareToken   String?         @unique
  isPublic     Boolean         @default(false)
  createdAt    DateTime        @default(now())
  updatedAt    DateTime        @updatedAt
  versions     PromptVersion[]

  @@index([userId])
  @@index([shareToken])
  @@map("prompts")
}

model PromptVersion {
  id          String   @id @default(cuid())
  promptId    String
  prompt      Prompt   @relation(fields: [promptId], references: [id], onDelete: Cascade)
  name        String
  description String?
  jsonData    Json
  version     Int
  createdAt   DateTime @default(now())

  @@index([promptId])
  @@map("prompt_versions")
}
